const http = require('http');
const app = require('../app'); 
var models = require('../server/models');


const port = parseInt(process.env.PORT, 10) || 8000;
app.set('port', port);

const server = http.createServer(app);


// setting up web socket / socket.io for MessageChat feature:
const io = require('socket.io').listen(server);

io.on("connection", socket => {
//  console.log("Socket Io: user connected");

  // listen for chat event
  socket.on("chat", msgInfo => {
//	 console.log(msgInfo);
	  io.emit("chat", msgInfo);
  });

// listen for typing event
socket.on("typing", msgInfo => {
	io.emit("typing", msgInfo);  // lets other clients know that sender is typing
})

});




models.sequelize.sync()
	.then(function() {
	server.listen(port, () => console.log(`Example app listening on port ${port}!`));
});